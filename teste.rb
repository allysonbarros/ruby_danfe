require_relative 'lib/ruby_danfe.rb'

@xml = %q{<?xml version='1.0' encoding='UTF-8'?><nfeProc xmlns="http://www.portalfiscal.inf.br/nfe" versao="2.00"><NFe xmlns="http://www.portalfiscal.inf.br/nfe"><infNFe Id="NFe35111101472720000112550030000365001018768956" versao="2.00"><ide><cUF>35</cUF><cNF>01876895</cNF><natOp>REMESSA EM DOACAO</natOp><indPag>2</indPag><mod>55</mod><serie>3</serie><nNF>36500</nNF><dEmi>2011-11-28</dEmi><tpNF>1</tpNF><cMunFG>3524709</cMunFG><tpImp>2</tpImp><tpEmis>1</tpEmis><cDV>6</cDV><tpAmb>1</tpAmb><finNFe>1</finNFe><procEmi>0</procEmi><verProc>NeoGrid NFe 1.4.9.4</verProc></ide><emit><CNPJ>01472720000112</CNPJ><xNome>MOTOROLA INDUSTRIAL LTDA</xNome><xFant>MOTOROLA INDUSTRIAL - JAGUARIUNA</xFant><enderEmit><xLgr>RODOVIA SP 340, KM128,7</xLgr><nro>S/N</nro><xCpl>S/N</xCpl><xBairro>TANQUINHO</xBairro><cMun>3524709</cMun><xMun>JAGUARIUNA</xMun><UF>SP</UF><CEP>13820000</CEP><cPais>1058</cPais><xPais>Brasil</xPais><fone>1938478000</fone></enderEmit><IE>395022296116</IE><IM>C5.51.5280</IM><CNAE>2632900</CNAE><CRT>3</CRT></emit><dest><CPF>09565995403</CPF><xNome>ALLYSON BRUNO CAMPOS B. VILELA</xNome><enderDest><xLgr>RUA SANTA LUZIA,</xLgr><nro>101</nro><xBairro>QUINTAS</xBairro><cMun>2408102</cMun><xMun>NATAL</xMun><UF>RN</UF><CEP>59035186</CEP><cPais>1058</cPais><xPais>BRASIL</xPais></enderDest><IE>ISENTO</IE><email>allysonbarrosrn@gmail.com</email></dest><det nItem="1"><prod><cProd>92009LYESA</cProd><cEAN>7892597861873</cEAN><xProd>MB525, TERMINAL PORTATIL DE TELEFONIA CELULAR MARCA MOTOROLA COMPOSTO DE</xProd><NCM>85171231</NCM><CFOP>6910</CFOP><uCom>UN</uCom><qCom>1.0000</qCom><vUnCom>561.7523400000</vUnCom><vProd>561.75</vProd><cEANTrib>7892597861873</cEANTrib><uTrib>UN</uTrib><qTrib>1.0000</qTrib><vUnTrib>561.7523400000</vUnTrib><indTot>1</indTot></prod><imposto><ICMS><ICMS20><orig>0</orig><CST>20</CST><modBC>0</modBC><pRedBC>0.00</pRedBC><vBC>578.60</vBC><pICMS>7.00</pICMS><vICMS>40.50</vICMS></ICMS20></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>50</CST><vBC>561.75</vBC><pIPI>3.00</pIPI><vIPI>16.85</vIPI></IPITrib></IPI><PIS><PISNT><CST>08</CST></PISNT></PIS><COFINS><COFINSNT><CST>08</CST></COFINSNT></COFINS></imposto><infAdProd>PRECO UNITARIO: 561.75234  ***  PROD.INFORMATICA.PORT.INTERMIN.MCT/MDIC/MF N 838/01 - REDUCAO DO IPI EM 80%, CONF. ALINEA A, INCISO II DO ARTIGO 4 DO DECRETO N 5.906/06  ***  Base Calculo ICMS Reduzida Conf. Inciso I Art 26 Anexo II RICMS/SP  ***  PROD.INFORMATICA.PORT.INTERMIN.MCT/MDIC/MF N 838/01 - REDUCAO DO IPI EM 80%, CONF. ALINEA A, INCISO II DO ARTIGO 4 DO DECRETO N 5.906/06</infAdProd></det><total><ICMSTot><vBC>578.60</vBC><vICMS>40.50</vICMS><vBCST>0.00</vBCST><vST>0.00</vST><vProd>561.75</vProd><vFrete>0.00</vFrete><vSeg>0.00</vSeg><vDesc>0.00</vDesc><vII>0.00</vII><vIPI>16.85</vIPI><vPIS>0.00</vPIS><vCOFINS>0.00</vCOFINS><vOutro>0.00</vOutro><vNF>578.60</vNF></ICMSTot></total><transp><modFrete>0</modFrete><transporta><CNPJ>10970887004191</CNPJ><xNome>RAPIDAO COMETA LOGISTICA E TRANSPORTE S/A</xNome><IE>671219827112</IE><xEnder>RUA FIORAVANTE MANCINO, 1560</xEnder><xMun>SUMARE</xMun><UF>SP</UF></transporta><vol><qVol>1</qVol><esp>vol</esp><pesoL>0.380</pesoL><pesoB>1.000</pesoB></vol></transp><infAdic><infCpl>CODIGO CLIENTE: 53247 *** PEDIDO:NRO-9560 *** NF LEGADO:244549</infCpl><obsCont xCampo="mailTransp"><xTexto>givaldos01@rapidaocometa.com.br</xTexto></obsCont></infAdic></infNFe><Signature xmlns="http://www.w3.org/2000/09/xmldsig#"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" /><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" /><Reference URI="#NFe35111101472720000112550030000365001018768956"><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" /><Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" /></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" /><DigestValue>3MWcnhkm7OJ48J6YAXhZWUJ0/5M=</DigestValue></Reference></SignedInfo><SignatureValue>ItLIerr/kLkptIVT35upC2mKcRsC5N8paL3v9chPyYNqM22ETQKlkjfMu7BuxAiRfOhuV+ccENZ/ZiI0rZonsuRQAw6FvJ5PT5j+KXqaE/jFhJ38sz2VRpYOxIigL3kg8fNLoNjG2fMH8GYptyghsg/NkjkHIp8XD+OPgVpVdfc=</SignatureValue><KeyInfo><X509Data><X509Certificate>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</X509Certificate></X509Data></KeyInfo></Signature></NFe><protNFe versao="2.00"><infProt><tpAmb>1</tpAmb><verAplic>5.0</verAplic><chNFe>35111101472720000112550030000365001018768956</chNFe><dhRecbto>2011-11-28T15:04:51</dhRecbto><nProt>135110635283285</nProt><digVal>3MWcnhkm7OJ48J6YAXhZWUJ0/5M=</digVal><cStat>100</cStat><xMotivo>Autorizado o uso da NF-e</xMotivo></infProt></protNFe></nfeProc>}

RubyDanfe.generate_from_xml_string('sample.pdf', xml)